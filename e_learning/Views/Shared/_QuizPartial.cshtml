@{

   

    // Lấy dữ liệu từ ViewBag
    var Quizzes = ViewBag.Quizzes as Data_Oracle.Entities.Quizzes;
    var Attempt = ViewBag.LatestAttempt as Data_Oracle.Entities.QuizAttempt;

    // Tính toán trạng thái hiển thị
    bool hasAttempt = Attempt != null;
    string scoreDisplay = hasAttempt ? Attempt.Score.ToString() + "%" : "--";
    string statusText = hasAttempt ? "Submitted on " + Attempt.AttemptDate.ToString("MMM dd, yyyy") : "You haven't submitted this yet.";

    // Màu sắc điểm số (Xanh nếu đậu, Đỏ nếu rớt, Xám nếu chưa thi)
    string gradeColor = "#ccc"; // Mặc định xám
    if (hasAttempt)
    {
        // Kiểm tra IsPass (Lưu ý: kiểu dữ liệu string "1"/"0" hay bool trong Model của bạn)
        bool isPass = Attempt.isPass == true;
        gradeColor = isPass ? "#28a745" : "#dc3545";
    }

}

<style>
    /* --- GIỮ NGUYÊN CÁC PHẦN CƠ BẢN --- */
    #video-player-container .quiz-wrapper-inner {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
        background-color: #f7f9fa;
        color: #333;
        padding: 20px;
        border-radius: 8px;
        /* Đảm bảo chiếm hết chiều cao */
        height: 100%;
        min-height: 450px;
        overflow-y: auto;
    }

    #video-player-container .quiz-container {
        width: 100%;
        max-width: 900px;
        margin: 0 auto;
    }

    #video-player-container .quiz-title {
        font-size: 1.8rem;
        font-weight: 700;
        color: #222;
        margin-bottom: 25px;
    }

    #video-player-container .card {
        background-color: #ffffff;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        padding: 25px;
        margin-bottom: 20px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }

    #video-player-container .card-title {
        font-size: 1.2rem;
        font-weight: 700;
        margin-top: 0;
        margin-bottom: 20px;
        color: #333;
        border-bottom: 1px solid #f0f0f0;
        padding-bottom: 10px;
    }

    /* --- PHẦN QUAN TRỌNG: SỬA LỖI VỠ LAYOUT --- */

    /* Sử dụng CSS Grid để chia 2 cột đều nhau */
    #video-player-container .quiz-info-grid {
        display: grid;
        /* Tự động chia 2 cột. Nếu màn hình nhỏ quá tự xuống 1 cột */
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 25px; /* Khoảng cách giữa các ô */
        margin-bottom: 10px;
    }

    #video-player-container .info-item {
        display: flex;
        align-items: flex-start;
    }

    #video-player-container .info-icon {
        font-size: 1.4rem; /* Icon to hơn chút */
        color: #0056d2;
        margin-right: 15px;
        margin-top: 3px;
        width: 24px;
        text-align: center;
    }

    #video-player-container .info-text-group {
        display: flex;
        flex-direction: column;
    }

    #video-player-container .info-label {
        font-size: 0.85rem;
        color: #666;
        text-transform: uppercase;
        font-weight: 600;
        letter-spacing: 0.5px;
        margin-bottom: 4px;
    }

    #video-player-container .info-value {
        font-size: 1rem;
        color: #111;
        font-weight: 500;
    }

    /* Nút Start căn chỉnh lại */
    #video-player-container .btn-start-container {
        display: flex;
        align-items: center;
        justify-content: flex-end;
        height: 100%; /* Để căn giữa theo chiều dọc với nội dung bên trái */
    }

    #video-player-container .btn-start {
        background-color: #0056d2;
        color: white;
        font-size: 1rem;
        font-weight: 600;
        border: none;
        border-radius: 6px;
        padding: 12px 35px;
        cursor: pointer;
        text-decoration: none;
        white-space: nowrap; /* Không cho chữ xuống dòng */
        transition: all 0.2s;
    }

    #video-player-container .btn-start:hover {
        background-color: #00419e;
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    /* Responsive: Màn hình nhỏ thì nút Start chạy xuống dưới */
    @*@media (max-width: 768px) {
        #video-player-container .btn-start-container {
            justify-content: flex-start;
            margin-top: 20px;
        }
    }*@
</style>

<div class="quiz-wrapper-inner">
    <div class="quiz-container">
        <h1 class="quiz-title">
            Practice quiz: Train the model
        </h1>

        <div class="card">
            <div class="row">
                <div class="col-md-9 col-sm-12">
                    <h2 class="card-title">Assignment details</h2>
                     
                    <div class="quiz-info-grid">

                        <div class="info-item">
                            <i class="far fa-calendar-alt info-icon"></i>
                            <div class="info-text-group">
                                <span class="info-label">Due Date</span>
                                <span class="info-value">@Quizzes.DueDate</span>
                            </div>
                        </div>

                        <div class="info-item">
                            <i class="fas fa-redo info-icon"></i>
                            <div class="info-text-group">
                                <span class="info-label">Attempts</span>
                                <span class="info-value">@Quizzes.Pass_Score_Percent</span>
                            </div>
                        </div>

                        <div class="info-item">
                            <i class="fas fa-list-ol info-icon"></i>
                            <div class="info-text-group">
                                <span class="info-label">Questions</span>
                                <span class="info-value">@Quizzes.NUMBER_QUESTIONS</span>
                            </div>
                        </div>

                        <div class="info-item">
                            <i class="far fa-clock info-icon"></i>
                            <div class="info-text-group">
                                <span class="info-label">Time Limit</span>
                                <span class="info-value">@Quizzes.TimeLimit</span>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="col-md-3 col-sm-12" style="margin-bottom:24px">
                    <div class="btn-start-container">
                        <a href="@Url.Action("Index", "Quizz", new {ChapterID = @Quizzes.ChapterID})" class="btn btn-start">
                            @(hasAttempt ? "Retake Quiz" : "Start Quiz") <i class="fas fa-chevron-right ml-2"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="card your-grade">
            <div class="d-flex justify-content-between align-items-center mb-2">
                <h2 class="card-title" style="border: none; margin: 0;">Your grade</h2>

                @if (hasAttempt)
                {
                    <a href="@Url.Action("ReviewQuiz", "Quizz", new { attemptId = Attempt.QuizAttemptID })"
                       class="btn btn-sm btn-outline-primary">
                        Review
                    </a>
                }
            </div>

            <p class="grade-status">@statusText</p>

            <span class="grade-placeholder" style="font-size: 2.5rem; font-weight: bold; color: @gradeColor;">
                @scoreDisplay
            </span>

            @if (hasAttempt)
            {
                <span style="font-weight: 600; color: @gradeColor; margin-left: 10px;">
                    @(gradeColor == "#28a745" ? "PASSED" : "FAILED")
                </span>
            }
        </div>
    </div>
</div>